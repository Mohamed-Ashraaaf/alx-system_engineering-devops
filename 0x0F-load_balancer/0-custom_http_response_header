#!/usr/bin/env bash
# This script configures Nginx to add a custom response header

sudo apt update
sudo apt install -y nginx
sudo ufw allow 'Nginx HTTP'

CONFIG_FILE="/etc/nginx/nginx.conf"
CUSTOM_HEADER="add_header X-Served-By \$hostname;"

sudo vim -c "normal G" -c "normal o \ \ add_header X-Served-By \$hostname;" -c "wq" /etc/nginx/nginx.conf

echo "Hello World!" | sudo tee /var/www/html/index.html
# OR
# echo "Hello World!" > index.html
# sudo mv index.html /var/www/html

echo "Ceci n'est pas une page" | sudo tee /var/www/html/404.html

echo "server {
    listen 80 default_server;
    listen [::]:80 default_server;
    add_header X-Served-By \$hostname;
    root /var/www/html;
    index index.html;
    location /redirect_me {
        return 301 https://www.youtube.com/watch?v=QH2-TGUlwu4;
    }
    error_page 404 /404.html;
    location = /404.html {
        internal;
    }
}" | sudo tee /etc/nginx/sites-available/default

sudo service nginx restart
