#!/usr/bin/env bash
# This script configures Nginx to add a custom response header

apt-get update
apt-get install -y nginx

CONFIG_FILE="/etc/nginx/nginx.conf"
CUSTOM_HEADER="add_header X-Served-By \$hostname;"

sudo sed -i '/server_tokens off;/a \ \ add_header X-Served-By $hostname;' /etc/nginx/nginx.conf
sed -i "s|# server_tokens off;|&\n\n    $CUSTOM_HEADER|g" $CONFIG_FILE

service nginx restart
